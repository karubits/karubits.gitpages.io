<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller)" /><meta property="og:locale" content="en" /><meta name="description" content="Prerequisites DHCP Server on the network Recommended: Configure Open 43 for automatic NTP time synchronization. The aruba AP will use this to set the correct time. A TFTP server. On Windows I recommended TFTPD64 A Serial cable for connecting to the Aruba access point directly. (e.g. DSD TECH SH-U09BL USB-TTL Serial Cable with CP2102N) On Windows for serial connections you will need Putty and on Linux the minicom package should work just fine. This guide is mainly focused on using Linux." /><meta property="og:description" content="Prerequisites DHCP Server on the network Recommended: Configure Open 43 for automatic NTP time synchronization. The aruba AP will use this to set the correct time. A TFTP server. On Windows I recommended TFTPD64 A Serial cable for connecting to the Aruba access point directly. (e.g. DSD TECH SH-U09BL USB-TTL Serial Cable with CP2102N) On Windows for serial connections you will need Putty and on Linux the minicom package should work just fine. This guide is mainly focused on using Linux." /><link rel="canonical" href="/posts/Converting_Aruba_AP_to_IAP/" /><meta property="og:url" content="/posts/Converting_Aruba_AP_to_IAP/" /><meta property="og:site_name" content="Karubits" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-13T01:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller)" /><meta name="twitter:site" content="@carll" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-13T11:08:34+09:00","datePublished":"2023-04-13T01:00:00+09:00","description":"Prerequisites DHCP Server on the network Recommended: Configure Open 43 for automatic NTP time synchronization. The aruba AP will use this to set the correct time. A TFTP server. On Windows I recommended TFTPD64 A Serial cable for connecting to the Aruba access point directly. (e.g. DSD TECH SH-U09BL USB-TTL Serial Cable with CP2102N) On Windows for serial connections you will need Putty and on Linux the minicom package should work just fine. This guide is mainly focused on using Linux.","headline":"Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller)","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Converting_Aruba_AP_to_IAP/"},"url":"/posts/Converting_Aruba_AP_to_IAP/"}</script><title>Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller) | Karubits</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Karubits"><meta name="application-name" content="Karubits"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Karubits</a></div><div class="site-subtitle font-italic">Welcome to カールビッツ, This site is a collection of guides and notes focused on Infrastructure, System Administration, Cloud Engineering and Devops workflows.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/karubits" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/carll" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['karubits','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller)</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1681315200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 13, 2023 </em> </span> <span> Updated <em class="" data-ts="1681351714" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 13, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/karubits">Karubits</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1179 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h2 id="prerequisites"><span class="mr-2">Prerequisites</span><a href="#prerequisites" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>DHCP Server on the network<li>Recommended: Configure Open 43 for automatic NTP time synchronization. The aruba AP will use this to set the correct time.<li>A TFTP server. On Windows I recommended <a href="https://pjo2.github.io/tftpd64/">TFTPD64</a><li>A Serial cable for connecting to the Aruba access point directly. (e.g. DSD TECH SH-U09BL USB-TTL Serial Cable with CP2102N)<li>On Windows for serial connections you will need <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">Putty</a> and on Linux the <a href="https://www.cyberciti.biz/tips/connect-soekris-single-board-computer-using-minicom.html">minicom</a> package should work just fine. This guide is mainly focused on using Linux.</ul><h3 id="downloading-the-aruba-instant-access-point-firmware"><span class="mr-2">Downloading the Aruba Instant Access Point firmware</span><a href="#downloading-the-aruba-instant-access-point-firmware" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>At the time of writhing it is possible to download the latest release of Instant Access Points without a HPE account.<li>Simply look at the file name of the release you want to download on their portal, in my case <code class="language-plaintext highlighter-rouge">ArubaInstant_Hercules_8.4.0.0_68230</code> then use wget while appending <code class="language-plaintext highlighter-rouge">http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/</code> to the firmware release name.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre> wget http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Hercules_8.11.1.0_86591
 <span class="nt">--2023-04-11</span> 13:20:40--  http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Hercules_8.11.1.0_86591
   
 ArubaInstant_Hercules_8.11.1.0_8 100%[<span class="o">=========================================================&gt;]</span>  22.29M  18.4MB/s    <span class="k">in </span>1.2s
   
 2023-04-11 13:20:42 <span class="o">(</span>18.4 MB/s<span class="o">)</span> - ‘ArubaInstant_Hercules_8.11.1.0_86591’ saved <span class="o">[</span>23370908/23370908]
</pre></table></code></div></div></ul><h3 id="setting-up-a-tftp-server-on-debianubuntu"><span class="mr-2">Setting up a TFTP Server on Debian/Ubuntu</span><a href="#setting-up-a-tftp-server-on-debianubuntu" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Allow TFTP network access (if you are using UFW)<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ufw allow tftp <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>ufw reload <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>ufw status numbered
</pre></table></code></div></div><li>Install the tftp service and tftp client.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>tftpd-hpa tftp
</pre></table></code></div></div><li>Create a directory for hosting files on the tftp server.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo mkdir</span> /opt/tftp-root
<span class="nb">sudo chown </span>tftp:tftp /opt/tftp-root
</pre></table></code></div></div><li>Edit the following flie <code class="language-plaintext highlighter-rouge">/etc/default/tftpd-hpa</code> and update the folder location to match the directory you created earlier.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># /etc/default/tftpd-hpa</span>
   
<span class="nv">TFTP_USERNAME</span><span class="o">=</span><span class="s2">"tftp"</span>
<span class="nv">TFTP_DIRECTORY</span><span class="o">=</span><span class="s2">"/opt/tftp-root"</span>
<span class="nv">TFTP_ADDRESS</span><span class="o">=</span><span class="s2">":69"</span>
<span class="nv">TFTP_OPTIONS</span><span class="o">=</span><span class="s2">"--secure"</span>
</pre></table></code></div></div><li>Restart the service<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart tftpd-hpa <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>systemctl status tftpd-hpa
</pre></table></code></div></div><li>If you are only going to use this tftp server for adhoc firmware updates then disable automatic startup.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl disable tftpd-hpa
</pre></table></code></div></div><li>Move your downloaded IAP firmware into the tftp directory and set the correct permissions.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo mv </span>ArubaInstant_Hercules_8.11.1.0_86591 /opt/tftp-root/
<span class="nb">sudo chown </span>tftp:tftp <span class="nt">-R</span> /opt/tftp-root
</pre></table></code></div></div><li>Test if you can download locally on your PC.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nb">cd</span> ~
tftp localhost
tftp&gt; binary
tftp&gt; get /ArubaInstant_Hercules_8.11.1.0_86591
Received 23370908 bytes <span class="k">in </span>0.4 seconds
tftp&gt; quit
<span class="nb">ls</span>
</pre></table></code></div></div><h3 id="stopping-tftpd-hpa-on-your-pc"><span class="mr-2">Stopping tftpd-hpa on your PC</span><a href="#stopping-tftpd-hpa-on-your-pc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When you have done using tftp-hpa its good practice to close the open holes and stop the service from running.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ufw delete allow 69/udp <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>ufw reload
<span class="nb">sudo </span>systemctl stop tftpd-hpa
</pre></table></code></div></div></ol><h1 id="procedure">Procedure</h1><h2 id="part-1---connecting-the-console-cable"><span class="mr-2">Part 1 - Connecting the console cable</span><a href="#part-1---connecting-the-console-cable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><p>Firstly you will need a serial adpator for connecting to Aruba access ports. As the serial connection is not a standard RJ45 connector like with other network devices I would recommend purchasing a breakout serial adaptor much like the one pictured below.</p><p><img data-src="/img/usb-serial-console.png" alt="DSD TECH SH-U09BL w/ CP2102N Chip" class="shadow" data-proofer-ignore> <em>DSD TECH SH-U09BL w/ CP2102N Chip</em></p><li><p>The console port is located under a rubber plug on the 300 series from Aruba. Lift up the rubber plug to expose the 4 pin connector.</p><p><img data-src="/img/aruba-310-rear.png" alt="Console Port" class="shadow" data-proofer-ignore> <em>Console Port Location</em></p><li><p>Connect the TX, RX,and Ground (GND) pins only.</p><p><img data-src="/img/aruba-310-console-pinout.png" alt="Console PIN Out" class="shadow" data-proofer-ignore> <em>Console Port Pin Out</em></p><li>On your PC you will need minicom installed.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> minicom
</pre></table></code></div></div><li>Plug in the USB serial adaptor to your PC and locate the device name. In this case I used a grep on the kernel logs and found the device was <code class="language-plaintext highlighter-rouge">ttyUSB0</code>.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">grep tty</span> /var/log/kern.log
Apr 11 12:54:59 MYPC kernel: <span class="o">[</span>2932193.187613] usb 3-5: FTDI USB Serial Device converter now attached to ttyUSB0
</pre></table></code></div></div><li>Connect to the device using <code class="language-plaintext highlighter-rouge">minicom</code><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>minicom <span class="nt">-b</span> 9600 <span class="nt">-o</span> <span class="nt">-D</span> /dev/ttyUSB0
</pre></table></code></div></div><li>Connect the network cable (PoE) to power up the AP.</ol><blockquote class="prompt-info"><div><p>If you don’t see any console output on your PC then you might need to reverse the TX and TX connectors which I had to do in my case with this particular USB adaptor.</p></div></blockquote><blockquote class="prompt-info"><div><p>If your keyboard input is not working make sure the HW and SW Flow Control is disabled with minicom.</p></div></blockquote><h2 id="part-2---reflashing-to-aruba-instant-access-point-iap"><span class="mr-2">Part 2 - Reflashing to Aruba Instant Access Point (IAP)</span><a href="#part-2---reflashing-to-aruba-instant-access-point-iap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Power on / Power cycle the access point.<li>Interrupt the apboot boot process by pressing enter. (Need to be quick)<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>APBoot 1.5.5.7 <span class="o">(</span>build 56398<span class="o">)</span>
Built: 2016-09-08 at 14:21:29
   
Model: AP-31x
DRAM:  491 MB
SF:    Detected MX25U3235F with page size 64 kB, total 4 MB
Flash: 4 MB
NAND:  132 MiB
PCIE0: <span class="nb">link </span>up
PCIE1: <span class="nb">link </span>up
       dev fn venID devID class  rev    MBAR0    MBAR1    MBAR2    MBAR3
       00  00  168c  0046 00002   00 00000004 00000000 00000000 00000000
Power: 802.3at POE
In:    serial
Out:   serial
Err:   serial
Net:   eth0
Radio: qca9983#0, qca9990#1
Reset: cold
FIPS:  passed 
   
Hit &lt;Enter&gt; to stop autoboot:  0 
apboot&gt; 
apboot&gt; 
</pre></table></code></div></div><li>You will need to get the serial number of the AP. A quick easy way is to simply type in <code class="language-plaintext highlighter-rouge">mfginfo</code> to display the hardware information of the device.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>apboot&gt; mfginfo
Inventory:
Card 0: System
        Wired MAC           : 38:17:c4:c3:b4:00
        Wired MAC Count     : 2
        Serial              : CNF3J0TXBY     <span class="c"># &lt;&lt;&lt; here</span>
        3
        Date Code           : 111017
Card 1: CPU
        Assembly            : 2010252C
        Major Rev           : 06
        Minor Rev/Variant   : 00
        Date Code           : 111017
Card 2: Antenna
        Minor Rev/Variant   : 01
</pre></table></code></div></div><li>Back on your Linux make (make sure you have openssl installed) use the serial number to generate a SHA1 hash with the region of your AP e.g. US (USA), RW (Rest of the World) and the serial number. In this example our AP is in the US region and the serial number is CNF3J0TXBY. It is also possible to change the region using this step as well (I personally have not validated this though).<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"US-CNF3J0TXBY"</span> | openssl sha1
SHA1<span class="o">(</span>stdin<span class="o">)=</span> 8f75c7d6e48fa2d974c23a6107bbff1997149c17
</pre></table></code></div></div><li>Using the has generated sha1 has use the following command on the AP to set the region.<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proginv system ccode CCODE-US-8f75c7d6e48fa2d974c23a6107bbff1997149c17
</pre></table></code></div></div><li>Then type in <code class="language-plaintext highlighter-rouge">invent -w</code> to convert AP to IAP.<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>invent -w
</pre></table></code></div></div><li>Bring up the network interface of the AP.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c"># If your network has DHCP</span>
dhcp
<span class="c"># If you need to setup a static IP address</span>
setenv ipaddr 192.168.41.10
</pre></table></code></div></div><li>Configure the TFTP Server address<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>setenv serverip 192.168.41.5
</pre></table></code></div></div><li>Download the IAP boot images from the TFTP server and apply them to both boot partitions.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>upgrade os 0 ArubaInstant_Hercules_8.11.1.0_86591
<span class="c"># wait for the image to be applied, then:</span>
upgrade os 1 ArubaInstant_Hercules_8.11.1.0_86591
</pre></table></code></div></div><li>Perform a factory reset.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>   factory_reset
</pre></table></code></div></div><li>Save the environment to make sure the “turn off mobility” will not appear<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>   saveenv
</pre></table></code></div></div><li>Then reset the device.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>   reset
</pre></table></code></div></div></ol><blockquote class="prompt-info"><div><p>After the device has rebooted, if you want to use the console login the username is <code class="language-plaintext highlighter-rouge">admin</code> and the password is the devices serial number e.g. <code class="language-plaintext highlighter-rouge">CNF3J0TXBY</code>. If you need to know the DHCP assigned IP of the access point after logging in you can type in <code class="language-plaintext highlighter-rouge">show ip interface brief</code></p></div></blockquote><blockquote class="prompt-info"><div><p>When logging in for the first time if you see this error <code class="language-plaintext highlighter-rouge">Internal error 8-0, please contact support</code> it just means the device is still initializing. Try again in a few minutes.</p></div></blockquote><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><em><a href="https://forums.servethehome.com/index.php?threads/aruba-ap-to-iap.29426/post-280609">Server the Home Forum - Aruba AP to IAP</a></em></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/network/'>network</a>, <a href='/categories/wifi/'>wifi</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/network/" class="post-tag no-text-decoration" >network</a> <a href="/tags/wap/" class="post-tag no-text-decoration" >wap</a> <a href="/tags/access-point/" class="post-tag no-text-decoration" >access point</a> <a href="/tags/aruba/" class="post-tag no-text-decoration" >aruba</a> <a href="/tags/iap/" class="post-tag no-text-decoration" >iap</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Converting+an+Aruba+AP+to+an+Instant+Access+Point+%28Without+a+Mobility+Controller%29+-+Karubits&url=%2Fposts%2FConverting_Aruba_AP_to_IAP%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Converting+an+Aruba+AP+to+an+Instant+Access+Point+%28Without+a+Mobility+Controller%29+-+Karubits&u=%2Fposts%2FConverting_Aruba_AP_to_IAP%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FConverting_Aruba_AP_to_IAP%2F&text=Converting+an+Aruba+AP+to+an+Instant+Access+Point+%28Without+a+Mobility+Controller%29+-+Karubits" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Converting_Aruba_AP_to_IAP/">Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller)</a><li><a href="/posts/proxmox-cloud-init-templates/">Proxmox cloud-init templates</a><li><a href="/posts/Yubikey-and-FIDO2-SSH/">Yubikey and FIDO 2 with SSH</a><li><a href="/posts/Linux-Storage-Notes/">Linux Storage Notes</a><li><a href="/posts/Unifi-Layer3-Adoption/">Unifi Layer 3 Adoption</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/controller/">controller</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/lpic/">lpic</a> <a class="post-tag" href="/tags/notes/">notes</a> <a class="post-tag" href="/tags/server-dell/">server. dell</a> <a class="post-tag" href="/tags/switches/">switches</a> <a class="post-tag" href="/tags/ubiquiti/">ubiquiti</a> <a class="post-tag" href="/tags/unifi/">unifi</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Unifi-Network-Controller/"><div class="card-body"> <em class="small" data-ts="1660352400" data-df="ll" > Aug 13, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Deploying a Unifi Network Controller</h3><div class="text-muted small"><p> Unifi Network Controller The Unifi Network Controller is a piece of software developed by Ubiquiti Inc, used for managing and administrating Unifi wireless access points, Unifi switches, and Unifi...</p></div></div></a></div><div class="card"> <a href="/posts/Unifi-Layer3-Adoption/"><div class="card-body"> <em class="small" data-ts="1660438800" data-df="ll" > Aug 14, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Unifi Layer 3 Adoption</h3><div class="text-muted small"><p> Adoption Methods There are three options for adopting devices over different networks. DNS Using DHCP options Manual configuration DNS If you have a internal DNS server that you manage ...</p></div></div></a></div><div class="card"> <a href="/posts/JunOS-Network-Notes/"><div class="card-body"> <em class="small" data-ts="1660438800" data-df="ll" > Aug 14, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Juniper JunOS Networking Notes</h3><div class="text-muted small"><p> Juniper ELS Examples (based on EX4300) Native VLANs on EX4300 ELS Switches # Create VLANS set vlans V1001_EMPLOYEE description &quot;[1001] Employee Network (10.8.240.1/24)&quot; set vlans V1001_EMPLOYEE vl...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Debian-Passwordless-Authentication/" class="btn btn-outline-primary" prompt="Older"><p>Setup Debian/Ubuntu (Gnome) with Passwordless Logins (U2F and Fingerprint)</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = '/posts/Converting_Aruba_AP_to_IAP/'; this.page.identifier = '/posts/Converting_Aruba_AP_to_IAP/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/karubits">Karubits</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Follow your curiosity.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/controller/">controller</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/lpic/">lpic</a> <a class="post-tag" href="/tags/notes/">notes</a> <a class="post-tag" href="/tags/server-dell/">server. dell</a> <a class="post-tag" href="/tags/switches/">switches</a> <a class="post-tag" href="/tags/ubiquiti/">ubiquiti</a> <a class="post-tag" href="/tags/unifi/">unifi</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-C4SSSQQJ4L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C4SSSQQJ4L'); }); </script>
