<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Yubikey and FIDO 2 with SSH" /><meta property="og:locale" content="en" /><meta name="description" content="To set a FIDO2 pin on a new device: ```` Check if a PIN has been set: ykman fido info" /><meta property="og:description" content="To set a FIDO2 pin on a new device: ```` Check if a PIN has been set: ykman fido info" /><link rel="canonical" href="/posts/Yubikey-and-FIDO2-SSH/" /><meta property="og:url" content="/posts/Yubikey-and-FIDO2-SSH/" /><meta property="og:site_name" content="Karubits" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-14T10:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Yubikey and FIDO 2 with SSH" /><meta name="twitter:site" content="@carll" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-07T09:45:11+09:00","datePublished":"2022-08-14T10:00:00+09:00","description":"To set a FIDO2 pin on a new device: ```` Check if a PIN has been set: ykman fido info","headline":"Yubikey and FIDO 2 with SSH","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Yubikey-and-FIDO2-SSH/"},"url":"/posts/Yubikey-and-FIDO2-SSH/"}</script><title>Yubikey and FIDO 2 with SSH | Karubits</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Karubits"><meta name="application-name" content="Karubits"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Karubits</a></div><div class="site-subtitle font-italic">Welcome to カールビッツ, This site is a collection of guides and notes focused on Infrastructure, System Administration, Cloud Engineering and Devops workflows.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/karubits" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/carll" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['karubits','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Yubikey and FIDO 2 with SSH</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Yubikey and FIDO 2 with SSH</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1660438800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 14, 2022 </em> </span> <span> Updated <em class="" data-ts="1680828311" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 7, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/karubits">Karubits</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="343 words"> <em>1 min</em> read</span></div></div></div><div class="post-content"><p>To set a FIDO2 pin on a new device:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># Check if a PIN has been set:
ykman fido info

# Set the PIN:
ykman fido access change-pin
</pre></table></code></div></div><p>Warning: Resetting the PIN will remove all FIDO2 credentials.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre># Example
ssh-keygen -t ed25519-sk -O resident \
    -O application=ssh:your-text-here \
    -C "$(date +'%d-%m-%Y')-physical_yubikey_number"



# Actual execution 
ssh-keygen -t ed25519-sk -O resident \
    -O application=ssh:emergency-ssh-access-desktop-server \
    -C "Emergency Key 1 - 10532500" 


ssh-keygen -t ed25519-sk -O resident \
    -O application=ssh:emergency-ssh-access-desktop-server \
    -C "Emergency Key 2 - 10653212"
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th>Factors<th>Description<th>Command<tbody><tr><td>No PIN or touch are required<td>You will not be required to enter your FIDO2 PIN or touch your YubiKey each time to authenticate<td><code class="language-plaintext highlighter-rouge">ssh-keygen -t ed25519-sk -O resident -O no-touch-required</code><tr><td>PIN but no touch required<td>Entering the PIN will be required but touching the physical key will not<td><code class="language-plaintext highlighter-rouge">ssh-keygen -t ed25519-sk -O resident -O verify-required -O no-touch-required</code><tr><td>No PIN but touch is required<td>You will only need to touch the YubiKey to authenticate<td><code class="language-plaintext highlighter-rouge">ssh-keygen -t ed25519-sk -O resident</code><tr><td>A PIN and a touch are required (<strong>most secure</strong>)<td>This is the most secure option, it requires both the PIN and touching to be used<td><code class="language-plaintext highlighter-rouge">ssh-keygen -t ed25519-sk -O resident -O verify-required</code></table></div><p>ref.</p><ul><li><a href="https://developers.yubico.com/SSH/Securing_SSH_with_FIDO2.html">Securing SSH with FIDO2</a><li><a href="https://www.yubico.com/blog/github-now-supports-ssh-security-keys/">GitHub now supports SSH security keys</a></ul><p>Using a Discoveral (resident) key has several benefits:</p><ol><li>Portability: Since the private key is stored on the YubiKey, you can use it on multiple devices without having to copy or transfer the key between them. Just plug in the YubiKey, and you can use the resident key for authentication.<li>Enhanced security: Resident keys are protected by the hardware security of the YubiKey. This makes it more difficult for an attacker to access or compromise the private key compared to when it is stored on a computer’s filesystem.</ol><p>However for the best security a non-discoverable credential is preferred. If the key was found they would not be able to use it for ssh access.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux/'>linux</a>, <a href='/categories/ssh/'>ssh</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/yubikey/" class="post-tag no-text-decoration" >yubikey</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a> <a href="/tags/fido/" class="post-tag no-text-decoration" >fido</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Yubikey+and+FIDO+2+with+SSH+-+Karubits&url=%2Fposts%2FYubikey-and-FIDO2-SSH%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Yubikey+and+FIDO+2+with+SSH+-+Karubits&u=%2Fposts%2FYubikey-and-FIDO2-SSH%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FYubikey-and-FIDO2-SSH%2F&text=Yubikey+and+FIDO+2+with+SSH+-+Karubits" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Converting_Aruba_AP_to_IAP/">Converting an Aruba AP to an Instant Access Point (Without a Mobility Controller)</a><li><a href="/posts/proxmox-cloud-init-templates/">Proxmox cloud-init templates</a><li><a href="/posts/Yubikey-and-FIDO2-SSH/">Yubikey and FIDO 2 with SSH</a><li><a href="/posts/Linux-Storage-Notes/">Linux Storage Notes</a><li><a href="/posts/Unifi-Layer3-Adoption/">Unifi Layer 3 Adoption</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/controller/">controller</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/lpic/">lpic</a> <a class="post-tag" href="/tags/notes/">notes</a> <a class="post-tag" href="/tags/server-dell/">server. dell</a> <a class="post-tag" href="/tags/switches/">switches</a> <a class="post-tag" href="/tags/ubiquiti/">ubiquiti</a> <a class="post-tag" href="/tags/unifi/">unifi</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Debian-Passwordless-Authentication/"><div class="card-body"> <em class="small" data-ts="1680890400" data-df="ll" > Apr 8, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setup Debian/Ubuntu (Gnome) with Passwordless Logins (U2F and Fingerprint)</h3><div class="text-muted small"><p> Setup Debian/Ubuntu (Gnome) with Passwordless Logins (U2F and Fingerprint) A short guide covering U2F (With a Yubikey) and Fingerprint logins for your PC. Instal the U2F Pam Module 1 sudo ...</p></div></div></a></div><div class="card"> <a href="/posts/proxmox-cloud-init-templates/"><div class="card-body"> <em class="small" data-ts="1672102800" data-df="ll" > Dec 27, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Proxmox cloud-init templates</h3><div class="text-muted small"><p> Introduction and why TODO Download cloud templates of your preferred distributions Listed below are the official download links for Debian and Ubuntu release Distro Release...</p></div></div></a></div><div class="card"> <a href="/posts/Linux-Storage-Notes/"><div class="card-body"> <em class="small" data-ts="1661994000" data-df="ll" > Sep 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linux Storage Notes</h3><div class="text-muted small"><p> A collection of rough notes around managing storage in Linux 1. Drive sanitization NIST Publiciation 800-88 Rev 1 - Guidelines for Media Sanitization 1.1 Secure Erase for NVME Drive Install ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Unifi-Network-Controller/" class="btn btn-outline-primary" prompt="Older"><p>Deploying a Unifi Network Controller</p></a> <a href="/posts/Unifi-Layer3-Adoption/" class="btn btn-outline-primary" prompt="Newer"><p>Unifi Layer 3 Adoption</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = '/posts/Yubikey-and-FIDO2-SSH/'; this.page.identifier = '/posts/Yubikey-and-FIDO2-SSH/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/karubits">Karubits</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Follow your curiosity.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/controller/">controller</a> <a class="post-tag" href="/tags/firmware/">firmware</a> <a class="post-tag" href="/tags/lpic/">lpic</a> <a class="post-tag" href="/tags/notes/">notes</a> <a class="post-tag" href="/tags/server-dell/">server. dell</a> <a class="post-tag" href="/tags/switches/">switches</a> <a class="post-tag" href="/tags/ubiquiti/">ubiquiti</a> <a class="post-tag" href="/tags/unifi/">unifi</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-C4SSSQQJ4L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C4SSSQQJ4L'); }); </script>
